"use strict";(()=>{var f=Object.defineProperty;var u=Object.getOwnPropertySymbols;var p=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable;var h=(r,o,t)=>o in r?f(r,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[o]=t,a=(r,o)=>{for(var t in o||={})p.call(o,t)&&h(r,t,o[t]);if(u)for(var t of u(o))d.call(o,t)&&h(r,t,o[t]);return r};var g=async r=>{let o=Date.now(),t={};Object.entries(r).forEach(([e,s])=>{t[e]={score:s,timestamp:o}}),await chrome.storage.local.set(t)},w=async r=>{let o=await chrome.storage.local.get(r),t={},e=Date.now(),s=15*60*1e3;return r.forEach(c=>{let n=o[c];n&&e-n.timestamp<s&&(t[c]=n.score)}),t},P=async r=>{if(!r.length)return{};try{let t=await fetch("https://scam-protector.com/api/bulk-score",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({hosts:r})});if(!t.ok)throw new Error(`API returned status: ${t.status}`);return await t.json()}catch(o){return console.error("Scam-Protector API error:",o),{}}};function y(r,o){let t=[];for(let e=0;e<r.length;e+=o)t.push(r.slice(e,e+o));return t}chrome.runtime.onMessage.addListener((r,o,t)=>{if(r.action==="getScores"){let{hosts:e}=r;return(async()=>{try{let s=await w(e),c=e.filter(m=>s[m]===void 0);if(c.length===0){t(s);return}let n=y(c,100),i={};for(let m of n){let S=await P(m);i=a(a({},i),S)}await g(i);let l=a(a({},s),i);t(l)}catch(s){console.error("Error processing score request:",s),t({})}})(),!0}});})();
